{
  "serviceImplementations": [
    {
      "name": "gateUp",
      "type": "HTTP",
      "cost": 0.0,
      "local": false,
      "scheme": "http",
      "host": "192.168.64.84",
      "port": 8001,
      "endPoint": "/gate/up",
      "method": "POST"
    },
    {
      "name": "gateDown",
      "type": "HTTP",
      "cost": 0.0,
      "local": false,
      "scheme": "http",
      "host": "192.168.64.84",
      "port": 8001,
      "endPoint": "/gate/down",
      "method": "POST"
    },
    {
      "name": "lightOn",
      "type": "HTTP",
      "cost": 0.0,
      "local": false,
      "scheme": "http",
      "host": "192.168.64.84",
      "port": 8002,
      "endPoint": "/light/on",
      "method": "POST"
    },
    {
      "name": "lightOff",
      "type": "HTTP",
      "cost": 0.0,
      "local": false,
      "scheme": "http",
      "host": "192.168.64.84",
      "port": 8002,
      "endPoint": "/light/off",
      "method": "POST"
    }
  ],
  "collaborativeStateMachine": {
    "name": "collaborativeStateMachine",
    "version": "0.1",
    "persistentContext": {
      "variables": [
        {
          "name": "persistentDataVariable",
          "value": "0"
        }
      ]
    },
    "stateMachines": [
      {
        "name": "crossing",
        "states": [
          {
            "name": "gate",
            "localContext": {
              "variables": [
                {
                  "name": "localDataVariable",
                  "value": "0"
                }
              ]
            },
            "states": [
              {
                "name": "up",
                "initial": true,
                "entry": [
                  {
                    "type": "assign",
                    "variable": {
                      "name": "localDataVariable",
                      "value": "utility:genRandPayload([1024, 1024 * 10, 1024 * 100, 1024 * 1000])"
                    }
                  }
                ],
                "on": [
                  {
                    "event": "gateUp",
                    "actions": [
                      {
                        "reference": "doGateUp"
                      }
                    ]
                  },
                  {
                    "event": "gateDown",
                    "target": "down"
                  }
                ]
              },
              {
                "name": "down",
                "entry": [
                  {
                    "type": "assign",
                    "variable": {
                      "name": "localDataVariable",
                      "value": "utility:genRandPayload([1024, 1024 * 10, 1024 * 100, 1024 * 1000])"
                    }
                  }
                ],
                "on": [
                  {
                    "event": "gateDown",
                    "actions": [
                      {
                        "reference": "doGateDown"
                      }
                    ]
                  },
                  {
                    "event": "gateUp",
                    "target": "up"
                  }
                ]
              }
            ],
            "actions": [
              {
                "name": "doGateUp",
                "type": "invoke",
                "serviceType": "gateUp"
              },
              {
                "name": "doGateDown",
                "type": "invoke",
                "serviceType": "gateDown"
              }
            ]
          },
          {
            "name": "light",
            "localContext": {
              "variables": [
                {
                  "name": "localDataVariable",
                  "value": "0"
                }
              ]
            },
            "states": [
              {
                "name": "off",
                "initial": true,
                "entry": [
                  {
                    "type": "assign",
                    "variable": {
                      "name": "localDataVariable",
                      "value": "utility:genRandPayload([1024, 1024 * 10, 1024 * 100, 1024 * 1000])"
                    }
                  }
                ],
                "on": [
                  {
                    "event": "lightOff",
                    "actions": [
                      {
                        "reference": "doLightOff"
                      }
                    ]
                  },
                  {
                    "event": "lightOn",
                    "target": "on"
                  }
                ]
              },
              {
                "name": "on",
                "entry": [
                  {
                    "type": "assign",
                    "variable": {
                      "name": "localDataVariable",
                      "value": "utility:genRandPayload([1024, 1024 * 10, 1024 * 100, 1024 * 1000])"
                    }
                  }
                ],
                "on": [
                  {
                    "event": "lightOn",
                    "actions": [
                      {
                        "reference": "doLightOn"
                      }
                    ]
                  },
                  {
                    "event": "lightOff",
                    "target": "off"
                  }
                ]
              }
            ],
            "actions": [
              {
                "name": "doLightOn",
                "type": "invoke",
                "serviceType": "lightOn"
              },
              {
                "name": "doLightOff",
                "type": "invoke",
                "serviceType": "lightOff"
              }
            ]
          },
          {
            "name": "away",
            "initial": true,
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "target": "approach"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOff"
                  },
                  {
                    "reference": "raiseGateUp"
                  }
                ]
              }
            ]
          },
          {
            "name": "approach",
            "entry": [
              {
                "type": "assign",
                "variable": {
                  "name": "persistentDataVariable",
                  "value": "utility:genRandPayload([1024, 1024 * 10, 1024 * 100, 1024 * 1000])"
                }
              }
            ],
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "target": "close"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOn"
                  },
                  {
                    "reference": "raiseGateDown"
                  }
                ]
              }
            ]
          },
          {
            "name": "close",
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "target": "present"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOn"
                  },
                  {
                    "reference": "raiseGateDown"
                  }
                ]
              }
            ]
          },
          {
            "name": "present",
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "target": "leaving"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOn"
                  },
                  {
                    "reference": "raiseGateDown"
                  }
                ]
              }
            ]
          },
          {
            "name": "leaving",
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "target": "left"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOff"
                  },
                  {
                    "reference": "raiseGateUp"
                  }
                ]
              }
            ]
          },
          {
            "name": "left",
            "on": [
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value == false"
                  }
                ],
                "target": "away"
              },
              {
                "event": "sensor",
                "guards": [
                  {
                    "expression": "$value"
                  }
                ],
                "actions": [
                  {
                    "reference": "raiseLightOff"
                  },
                  {
                    "reference": "raiseGateUp"
                  }
                ]
              }
            ]
          }
        ],
        "actions": [
          {
            "name": "raiseGateUp",
            "type": "raise",
            "event": {
              "name": "gateUp",
              "channel": "internal"
            }
          },
          {
            "name": "raiseGateDown",
            "type": "raise",
            "event": {
              "name": "gateDown",
              "channel": "internal"
            }
          },
          {
            "name": "raiseLightOn",
            "type": "raise",
            "event": {
              "name": "lightOn",
              "channel": "internal"
            }
          },
          {
            "name": "raiseLightOff",
            "type": "raise",
            "event": {
              "name": "lightOff",
              "channel": "internal"
            }
          }
        ]
      }
    ]
  },
  "stateMachineName": "crossing",
  "localData": {},
  "bindEventInstanceIds": [],
  "runtimeName": "runtime"
}
